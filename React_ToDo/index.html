<!DOCTYPE html>

<html lnag="ja">
    <head>
        <meta charset="utf-8">
        <title>React ToDo App</title>
        <link rel="stylesheet" href="css/styles.css">
          <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
          <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
          <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    
    </head>
    <body>
        <div id="root"></div>
        <script type="text/babel">
        (() => {
            const todos = [
                {id:0, title:'Task 0', isDone: false},
                {id:1, title:'Task 1', isDone: false},
                {id:2, title:'Task 2', isDone: true}
            ];
                  
            /*This function called from function TodoList*/
            function TodoItem(props){
                /* To create check box*/
                return (
                    <li key={props.todo.id}>
                        
                        <label> 
                            <input type="checkbox" 
                                checked={props.todo.isDone}
                                onChange={() => props.checkTodo(props.todo)}    
                            ></input>
                            
                            <span className={props.todo.isDone ? 'done' : ''}>
                                {props.todo.title}
                            </span>
                            
                        </label>
                    </li>
                );
            }
            
            function TodoList(props){
                const todos = props.todos.map(todo =>{
                    return(
                        /* create component item for 
                        <li key={todo.id}>{todo.title}</li>*/
                        <TodoItem
                            key={todo.id}
                            todo={todo}
                            checkTodo={props.checkTodo}
                        />
                        
                    );
                });
                
                return (
                <ul>
                    {todos}
                </ul>
                )
            }
            
            class App extends React.Component {
                constructor(){
                    super();
                    this.state={
                      todos: todos  
                    };
                    this.checkTodo = this.checkTodo.bind(this);
                }
                
                checkTodo(todo) {
                    const todos = this.state.todos.map(todo =>{
                        return {id: todo.id, title:todo.title, isDone:todo.isDone};
                        
                    });
                    
                    const position = this.state.todos.map(todo => {
                        return todo.id;
                    }).indexOf(todo.id);
                               
                    todos[position].isDone = !todos[position].isDone;
                    this.setState({
                               todos: todos
                               });
                }
                
                render() {
                    return(
                        <div>
                            <h1>My ToDos</h1>
                            
                            <TodoList 
                                todos={this.state.todos}
                                checkTodo={this.checkTodo}
                            />
                            
                        </div>
                    );
                }
            }
            
            ReactDOM.render(
            <App/>,
            document.getElementById('root')
            );
        })();
        </script>
        
    </body>
</html>
